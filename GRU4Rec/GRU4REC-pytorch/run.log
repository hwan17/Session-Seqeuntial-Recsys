Loading train data from /content/drive/MyDrive/커리어/추천알고리즘_스터디/[2023 하반기]추천알고리즘 스터디/code/GRU4Rec/GRU4REC-pytorch-master/GRU4REC-pytorch-master/RecSys_Dataset_After/recSys15TrainOnly.txt
Loading valid data from /content/drive/MyDrive/커리어/추천알고리즘_스터디/[2023 하반기]추천알고리즘 스터디/code/GRU4Rec/GRU4REC-pytorch-master/GRU4REC-pytorch-master/RecSys_Dataset_After/recSys15Valid.txt
itemmap is None           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
item2idx 214536502        0
214536500        1
214536506        2
214577561        3
214662742        4
             ...  
214865655    37478
214862115    37479
214864948    37480
214856739    37481
214863240    37482
Length: 37483, dtype: int64
itemmap           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
itemmap is None           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
itemmap           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
before base self.df           SessionID          Time     ItemID
0                 1  1.396868e+09  214536502
1                 1  1.396868e+09  214536500
2                 1  1.396868e+09  214536506
3                 1  1.396868e+09  214577561
4                 2  1.396879e+09  214662742
...             ...           ...        ...
31637234   11299809  1.411638e+09  214819412
31637235   11299809  1.411638e+09  214830939
31637236   11299811  1.411585e+09  214854855
31637237   11299811  1.411585e+09  214854838
31637238   11299811  1.411585e+09  214848658

[31637239 rows x 3 columns]
after self.df           SessionID          Time     ItemID  item_idx
0                 1  1.396868e+09  214536502         0
1               561  1.396427e+09  214536502         0
2               877  1.396901e+09  214536502         0
3              1343  1.396865e+09  214536502         0
4              3168  1.396350e+09  214536502         0
...             ...           ...        ...       ...
31637234   11348624  1.411666e+09  214863240     37482
31637235   11298384  1.411599e+09  214863240     37482
31637236   11298384  1.411599e+09  214863240     37482
31637237   11298383  1.411481e+09  214863240     37482
31637238   11298383  1.411481e+09  214863240     37482

[31637239 rows x 4 columns]
before offsets [0 0 0 ... 0 0 0]
self.df.groupby(self.session_key).size() SessionID
1           4
2           6
3           3
4           2
6           2
           ..
11562152    2
11562153    2
11562156    2
11562157    2
11562158    3
Length: 7966257, dtype: int64
after offsets [       0        4       10 ... 31637234 31637236 31637239]
time_sort false: session_idx_arr [      0       1       2 ... 7966254 7966255 7966256]
itemmap is None           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
itemmap           ItemID  item_idx
0      214536502         0
1      214536500         1
2      214536506         2
3      214577561         3
4      214662742         4
...          ...       ...
37478  214865655     37478
37479  214862115     37479
37480  214864948     37480
37481  214856739     37481
37482  214863240     37482

[37483 rows x 2 columns]
before base self.df        SessionID          Time     ItemID
0       11265009  1.412004e+09  214586805
1       11265009  1.412004e+09  214509260
2       11265017  1.412018e+09  214857547
3       11265017  1.412018e+09  214857268
4       11265017  1.412018e+09  214857260
...          ...           ...        ...
71217   11299816  1.412021e+09  214859859
71218   11299816  1.412021e+09  214859859
71219   11299816  1.412022e+09  214859859
71220   11299816  1.412023e+09  214746399
71221   11299816  1.412023e+09  214567327

[71222 rows x 3 columns]
after self.df        SessionID          Time     ItemID  item_idx
0       11265009  1.412004e+09  214586805      4811
1       11264314  1.412019e+09  214586805      4811
2       11264314  1.412019e+09  214586805      4811
3       11265808  1.411992e+09  214586805      4811
4       11265808  1.411992e+09  214586805      4811
...          ...           ...        ...       ...
71217   11299318  1.411988e+09  214857425     35220
71218   11299538  1.412043e+09  214743594     29594
71219   11299538  1.412043e+09  214744235     21472
71220   11299838  1.411984e+09  214848255     29523
71221   11299816  1.412023e+09  214746399      3649

[71222 rows x 4 columns]
before offsets [0 0 0 ... 0 0 0]
self.df.groupby(self.session_key).size() SessionID
11255568     2
11255571     2
11255572     2
11255599     5
11255661     2
            ..
11562034     8
11562079     5
11562117     2
11562118     3
11562142    22
Length: 15324, dtype: int64
after offsets [    0     2     4 ... 71197 71200 71222]
time_sort false: session_idx_arr [    0     1     2 ... 15321 15322 15323]
PARAMETER----------
BATCH_SIZE=50
CHECKPOINT_DIR=checkpoint/08140317
CUDA=False
DATA_FOLDER=/content/drive/MyDrive/커리어/추천알고리즘_스터디/[2023 하반기]추천알고리즘 스터디/code/GRU4Rec/GRU4REC-pytorch-master/GRU4REC-pytorch-master/RecSys_Dataset_After/
DROPOUT_HIDDEN=0.5
DROPOUT_INPUT=0
EMBEDDING_DIM=-1
EPS=1e-06
FINAL_ACT=tanh
HIDDEN_SIZE=100
IS_EVAL=False
K_EVAL=20
LOAD_MODEL=None
LOSS_TYPE=TOP1-max
LR=0.01
MODEL_NAME=GRU4REC-CrossEntropy
MOMENTUM=0
N_EPOCHS=5
NUM_LAYERS=3
OPTIMIZER_TYPE=Adagrad
SAVE_DIR=models
SEED=22
SIGMA=None
TIME_SORT=False
TRAIN_DATA=recSys15TrainOnly.txt
VALID_DATA=recSys15Valid.txt
WEIGHT_DECAY=0
-------------------
#### START TRAINING....
Start Epoch # 0
